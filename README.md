# **Malware-Analysis-with-Ensemble-Modeling**

## **Problem Definition**

We would like to study that for the same program, whether the
integration of different analysis methods would result in a better accuracy.

## **Dataset**

- PE Section Headers: https://www.kaggle.com/datasets/ang3loliveira/malware-analysis-datasets-pe-section-headers

- Top-1000 PE Imports: https://www.kaggle.com/datasets/ang3loliveira/malware-analysis-datasets-top1000-pe-imports

- Raw PE as Image: https://www.kaggle.com/datasets/ang3loliveira/malware-analysis-datasets-raw-pe-as-image

- ## **Experiment / Model Description**


1. Pre-processing: After importing all three datasets to Colab, we merged them together by the column "hash "and thus dropped duplicates and un-used columns. With EDA (Exploratory Data Analysis), we found that we have an unbalanced dataset, so we applied resampling by ADASYN (Adaptive Synthetic), and got our train_df at last.

2. Header Data: After standardization, we applied Deep Neural Network (DNN) on the header data section (X[:, 0:5]).

3. Raw PE Images: Using the PE Image section (X[:, 1004:]), we first re-shaped our data from (81510, 1024) to (81510, 32, 32) and applied Convolutional Neural Network (CNN) on the section.

4. PE Imports: For this section (X[:, 5:1005]), we used similar methods to the header data section, which is DNN, to perform machine learning on our data.

5. Ensemble Learning: With all three models done, we combined the outputs of the models by keras.layers.concatenate and added a dense layer at the end to perform our final ensemble model.


## **Result**

As we trianed and compiled all four models to do predictions on malware, we found out that the ensembled model had the highest accuracy and the lowest loss (as we expected). The following are the precise numbers and percentages on our experiment.

1. Header Data: training accuracy 86.45% and validation accuracy 67.49%.
2. PE Images: training accuracy 91.32% and validation accuracy 85.42%.
3. PE Imports :training accuracy 96.81% and validation accuracy 96.44%
4. Ensembled: training accuracy 97.78% and validation accuracy 97.58%.


## **Discussion**

Regarding future work, we would like to further see whether other preprocessing methods such as PCA to reduce dimensionality and SMOTE rather that ADASYN as the resampling methods would affect on our experiment.
